# Maintainer: Richard Hillmann <richie at project0 dot de>
pkgname=project0-sweet-gtk-themes
pkgver=20220820
pkgrel=1
pkgdesc="Sweet themes"
arch=('any')
url="https://github.com/EliverLara/Sweet"
license=('GNU')
conflicts=(
    sweet-gtk-theme
)

_kinds=(
    Sweet
    Sweet-mars
    Sweet-nova
    Sweet-Ambar
    Sweet-Ambar-Blue
)
_commits=(
    90afc51 # Sweet
    3fa79ba # Sweet-mars
    0061be8 # Sweet-nova
    c1b92f1 # Sweet-Ambar
    3be6422 # Sweet-Ambar-Blue
)

function srcname () {
    c="${_commits[$1]}"
    k="${_kinds[$1]}"
    echo "git.${pkgname}-${k}-${c}"
}


for i in "${!_kinds[@]}"; do
    c="${_commits[$i]}"
    k="${_kinds[$i]}"
    source+=("$(srcname "$i")::git+https://github.com/EliverLara/Sweet.git#commit=$c")
done

sha256sums=('SKIP'
            'SKIP'
            'SKIP'
            'SKIP'
            'SKIP')

pkgver() {
    (cd "${srcdir}/$(srcname "0")" && git log -1 --format=%ad --date=format:'%Y%m%d')
}

prepare() {
    find "${srcdir}" -type f -name "*scss" -delete
    rm -rf "${srcdir}"/*/{Art,src}
    find "${srcdir}" -type d -empty -delete
}

package() {
    themes="${pkgdir}/usr/share/themes"

    for i in "${!_kinds[@]}"; do
        k="${_kinds[$i]}"
        install -dm755 "${themes}/${k}"
        cp -r "${srcdir}/$(srcname "$i")/"* "${themes}/${k}/"
    done
}
